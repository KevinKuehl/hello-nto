#
# Copyright 2019 Kevin Kuehl
#
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.
#
imports:
- path: gke-cluster-template.jinja

# Create an GKE cluster
resources:
- name: dev-cluster-ams
  type: gke-cluster-template.jinja
  properties:
    zone: us-central1-c
    initialNodeCount: 2
    initialClusterVersion: 1.12.5-gke.5
    network: dev-custom-network
    subnetwork: dev-network-ams
    clusterIpv4Cidr: 172.17.0.0/16
#
#  {
#    "cluster": {
#      "name": "standard-cluster-1",
#      "masterAuth": {
#        "clientCertificateConfig": {}
#      },
#      "loggingService": "logging.googleapis.com",
#      "monitoringService": "monitoring.googleapis.com",
#      "network": "projects/ktlx-info-k8s-istio-1/global/networks/default",
#      "addonsConfig": {
#        "httpLoadBalancing": {},
#        "kubernetesDashboard": {
#          "disabled": true
#        },
#        "istioConfig": {
#          "disabled": true
#        }
#      },
#      "subnetwork": "projects/ktlx-info-k8s-istio-1/regions/us-central1/subnetworks/default",
#      "nodePools": [
#      {
#        "name": "default-pool",
#        "config": {
#          "machineType": "n1-standard-1",
#          "diskSizeGb": 100,
#          "oauthScopes": [
#            "https://www.googleapis.com/auth/devstorage.read_only",
#            "https://www.googleapis.com/auth/logging.write",
#            "https://www.googleapis.com/auth/monitoring",
#            "https://www.googleapis.com/auth/servicecontrol",
#            "https://www.googleapis.com/auth/service.management.readonly",
#            "https://www.googleapis.com/auth/trace.append"
#          ],
#          "metadata": {
#            "disable-legacy-endpoints": "true"
#          },
#          "imageType": "COS",
#          "diskType": "pd-standard"
#        },
#        "initialNodeCount": 3,
#        "autoscaling": {},
#        "management": {
#          "autoUpgrade": true,
#          "autoRepair": true
#        },
#        "version": "1.12.5-gke.5"
#      }
#      ],
#      "networkPolicy": {},
#      "ipAllocationPolicy": {},
#      "masterAuthorizedNetworksConfig": {},
#      "privateClusterConfig": {},
#      "databaseEncryption": {
#        "state": "DECRYPTED"
#      },
#      "initialClusterVersion": "1.12.5-gke.5",
#      "location": "us-central1-c"
#    }
#  }
